{
    "executable": "$PWD/build/default/src/app-feelpp-io/feelpp_app_io",
    "output_directory": "{{machine.output_app_dir}}/app-feelpp-io/io",
    "use_case_name": "eye-mesh",
    "timeout":"0-01:00:00",
    "resources":{
        "tasks":"{{parameters.resources.tasks.value}}",
        "exclusive_access":"{{parameters.resources.exclusive_access.value}}"
    },
    "input_file_dependencies":{
        "mesh_json":"benchmark/Eye2Brain/mesh/{{parameters.mesh.value}}/Eye_Mesh3D_p{{parameters.resources.tasks.value}}.json",
        "mesh_hdf5":"benchmark/Eye2Brain/mesh/{{parameters.mesh.value}}/Eye_Mesh3D_p{{parameters.resources.tasks.value}}.h5"
    },
    "platforms": {
        "apptainer":{
            "image": {
                "filepath":"{{machine.containers.apptainer.image_base_dir}}/feelpp-noble.sif"
            },
            "input_dir":"/input_data",
            "options": [
                "--home {{machine.output_app_dir}}",
                "--bind {{machine.input_dataset_base_dir}}/:{{platforms.apptainer.input_dir}}",
                "--env OMP_NUM_THREADS=1"
            ],
            "append_app_option":[]
        },
        "builtin":{
            "input_dir":"{{machine.input_dataset_base_dir}}",
            "append_app_option":[]
        }
    },
    "options": [
        "--directory {{output_directory}}/{{instance}}/{{use_case_name}}",
        "--discretization {{parameters.discretization.value}}",
        "--repository.append.np 0",
        "--gmsh.filename $PWD/{{input_file_dependencies.mesh_json}}"
    ],
    "additional_files":{
        "custom_logs":[
            "{{output_directory}}/{{instance}}/{{use_case_name}}/logs/{{executable}}.INFO",
            "{{output_directory}}/{{instance}}/{{use_case_name}}/logs/{{executable}}.WARNING"
        ]
    },
    "scalability": {
        "directory": "{{output_directory}}/{{instance}}/{{use_case_name}}",
        "clean_directory":true,
        "stages": [
            {
                "name": "timeMeasures",
                "filepath": "time_measures.json",
                "format": "json",
                "variables_path": "time.*",
                "units": { "*": "s"}
            }
        ]
    },
    "sanity": {
        "success": [],
        "error": []
    },
    "parameters": [
        {
            "name": "resources",
            "zip":[
                {
                    "name":"tasks",
                    "sequence":[1, 2, 4, 8, 16, 64, 96, 128, 256]
                },
                {
                    "name":"exclusive_access",
                    "repeat":{"value": true, "count": 10}
                }
            ]
        },
        {
            "name":"mesh",
            "sequence":["M2", "M3", "M4", "M5"],
            "conditions":{
                "M5":[{ "resources.tasks":[1, 2, 4, 8, 16, 64, 96] }]
            }
        },
        {
            "name":"discretization",
            "sequence":["P1", "P2", "P3", "P4", "P5", "P6"]
        }
    ]
}
